
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>IBM Watson Machine Learning Community Edition (WMLCE) &#8212; MIT Satori User Documentation  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Distributed Deep Learning" href="satori-distributed-deeplearning.html" />
    <link rel="prev" title="Satori Quick Start Info" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
    <link rel="canonical" href="https://researchcomputing.mit.edusatori-ai-frameworks.html"/>
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="ibm-watson-machine-learning-community-edition-wmlce">
<h1>IBM Watson Machine Learning Community Edition (WMLCE)<a class="headerlink" href="#ibm-watson-machine-learning-community-edition-wmlce" title="Permalink to this headline">¶</a></h1>
<p>Watson ML CE is an IBM Cognitive Systems offering that is designed for
the rapidly growing and quickly evolving AI category of deep learning.
Watson ML CE brings a suite of capabilities from the open source
community and combines them into a single enterprise distribution of
software that incorporates complete lifecycle management from
installation and configuration; data ingest and preparation; building,
optimizing, and training the model; to inference; testing; and moving
the model into production. Watson ML CE takes advantage of a distributed
architecture to help enable your teams to quickly iterate through the
training cycle on more data to help continuously improve the model over
time.</p>
<p>Watson ML CE is designed for scale, with software optimised for both
single server and cluster deep learning training. It offers many
optimizations that can ease installation and management, and can help
accelerate performance:</p>
<ul class="simple">
<li>Ready-to-use deep learning frameworks (TensorFlow, PyTorch, Caffe,
Caffe2, ONNX, and Keras).</li>
<li>Powerful and scalable machine learning libraries (Snap ML and NVIDIA
RAPIDS).</li>
<li>Distributed as prebuilt containers, or on demand through the Conda
provisioning process.</li>
<li>Includes dependencies and libraries.</li>
<li>Easy updates: Code updates arrive from a repository.</li>
<li>Validated deep learning platform with each release.</li>
<li>Dedicated support teams for deep learning.</li>
<li>Designed for enterprise scale with multisystem cluster performance
and large memory support.</li>
<li>Supported on GPU accelerated IBM AC922 servers; and also supported on
accelerated x86 architecture servers.</li>
</ul>
<div class="figure align-default" id="id1">
<img alt="WMLCE" src="_images/Satori-WMLCE_Infographic.png" />
<p class="caption"><span class="caption-text">WMLCE</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="install-anaconda">
<h2>[1] Install Anaconda<a class="headerlink" href="#install-anaconda" title="Permalink to this headline">¶</a></h2>
<p>All users on Satori will have two folders:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/home/&lt;username&gt;
/nobackup/users/&lt;username&gt;
</pre></div>
</div>
<p>please download and install Anaconda3 in the: /nobackup/users/&lt;your-username&gt;/anaconda3
This is because /nobackup disk partition has way much more space compared with /home. In addition all files in /home will be automaticlay backuped compared with /nobackup partition. Anaconda3 can be install at any time in less then 10 minutes, therefore no backup is need.</p>
<p>To install WMLCE you need to install on your login account <a class="reference external" href="https://www.anaconda.com/distribution/#download-section" target="_blank">Anaconda for
POWER9/ ppc64le
architecture</a>.
download of the Anaconda can be done using <code class="docutils literal notranslate"><span class="pre">wget</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /nobackup/users/<span class="k">$(</span>whoami<span class="k">)</span>
wget https://repo.anaconda.com/archive/Anaconda3-2019.10-Linux-ppc64le.sh
sh Anaconda3-2019.10-Linux-ppc64le.sh -f -p /nobackup/users/<span class="k">$(</span>whoami<span class="k">)</span>/anaconda3
<span class="nb">source</span> ~/.bashrc
</pre></div>
</div>
<p>By default Anaconda will be insalled in your home folder under
<code class="docutils literal notranslate"><span class="pre">anaconda3</span></code> and all the WMLCE pachages will be install in a
sub-directory on chosen virtual name/folder (ie.
anaconda3/envs/wmlce-1.6.2)</p>
</div>
<div class="section" id="wmlce-setting-up-the-software-repository">
<h2>[2] WMLCE: Setting up the software repository<a class="headerlink" href="#wmlce-setting-up-the-software-repository" title="Permalink to this headline">¶</a></h2>
<p>The WML CE MLDL packages are distributed as conda packages in an online
conda repository. conda must be configured to give priority to
installing packages from this channel.</p>
<p>Add the WML CE channel to the conda configuration by running the
following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda config --prepend channels <span class="se">\</span>
https://public.dhe.ibm.com/ibmdl/export/pub/software/server/ibm-ai/conda/
</pre></div>
</div>
</div>
<div class="section" id="wmlce-creating-and-activate-conda-environments-recommended">
<h2>[3] WMLCE: Creating and activate conda environments (recommended)<a class="headerlink" href="#wmlce-creating-and-activate-conda-environments-recommended" title="Permalink to this headline">¶</a></h2>
<p>With conda, you can create environments that have different versions of
Python or packages installed in them. Conda environments are optional
but recommended. If not used, packages are installed in the default
environment called base, which often has a higher risk of containing
conflicting packages or dependencies. Switching between environments is
called activating the environment.</p>
<p>The syntax to create and activate a conda environment is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda create --name &lt;environment name&gt; <span class="nv">python</span><span class="o">=</span>&lt;python version&gt;
conda activate &lt;environment name&gt;
</pre></div>
</div>
<p>The only valid Python versions with WML CE are Python 3.6 and 3.7. For
example, to create an environment named wmlce_env with Python 3.6:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda create --name wmlce-1.6.2 <span class="nv">python</span><span class="o">=</span><span class="m">3</span>.6
conda activate wmlce-1.6.2
</pre></div>
</div>
</div>
<div class="section" id="wmlce-installing-all-frameworks-at-the-same-time">
<h2>[4] WMLCE: Installing all frameworks at the same time<a class="headerlink" href="#wmlce-installing-all-frameworks-at-the-same-time" title="Permalink to this headline">¶</a></h2>
<p>All the MLDL frameworks except RAPIDS packages can be installed at the
same time by using the powerai meta-package. All the RAPIDS packages can
be installed using the powerai-rapids meta-package.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install powerai
</pre></div>
</div>
<p>Additionaly pachages can be installed with the conda environment
activated, runining the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install &lt;package name&gt;
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install powerai-rapids
conda install dali
conda install apex
</pre></div>
</div>
<p>NOTE: During the conda install, the packages are downloaded from the
internet and after downloading, the license agreement is presented. Read
the license agreement and accept the terms and conditions to complete
the install. If you decline the license agreement the packages are not
installed. After you finish reading the license agreement, future
installations can be automated to silently accept the license agreement
by running the following command before running the conda install
command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">IBM_POWERAI_LICENSE_ACCEPT</span><span class="o">=</span>yes
</pre></div>
</div>
<p>The license accept has to be done only once on a per user basis.</p>
</div>
<div class="section" id="wmlce-testing-ml-dl-frameworks-pytorch-tensorflow-etc-installation">
<h2>[5] WMLCE: Testing ML/DL frameworks (Pytorch, TensorFlow etc) installation<a class="headerlink" href="#wmlce-testing-ml-dl-frameworks-pytorch-tensorflow-etc-installation" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda activate wmlce-1.6.2
python
</pre></div>
</div>
<ol class="loweralpha simple">
<li>PYTORCH</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>import torch
import torch.nn as nn
import torch.nn.functional as F
import torch.optim as optim
torch.manual_seed<span class="o">(</span><span class="m">1</span><span class="o">)</span>
<span class="nv">lin</span> <span class="o">=</span> nn.Linear<span class="o">(</span><span class="m">5</span>, <span class="m">3</span><span class="o">)</span>  <span class="c1"># maps from R^5 to R^3, parameters A, b</span>
<span class="c1"># data is 2x5.  A maps from 5 to 3... can we map &quot;data&quot; under A?</span>
<span class="nv">data</span> <span class="o">=</span> torch.randn<span class="o">(</span><span class="m">2</span>, <span class="m">5</span><span class="o">)</span>
print<span class="o">(</span>lin<span class="o">(</span>data<span class="o">))</span>  <span class="c1"># yes</span>
</pre></div>
</div>
<ol class="loweralpha simple" start="2">
<li>TensorFlow</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>import tensorflow as tf
from __future__ import print_function
<span class="c1"># Create a Constant op</span>
<span class="c1"># The op is added as a node to the default graph.</span>
<span class="c1">#</span>
<span class="c1"># The value returned by the constructor represents the output</span>
<span class="c1"># of the Constant op.</span>
<span class="nv">hello</span> <span class="o">=</span> tf.constant<span class="o">(</span><span class="s1">&#39;Hello, TensorFlow!&#39;</span><span class="o">)</span>
<span class="c1"># Start tf session</span>
<span class="nv">sess</span> <span class="o">=</span> tf.Session<span class="o">()</span>
<span class="c1"># Run the op</span>
print<span class="o">(</span>sess.run<span class="o">(</span>hello<span class="o">))</span>
</pre></div>
</div>
<p>c. Caffe
Test with LSF workload manager; this will run remote in one of the Satori compute nodes available</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/
conda install keras
wget https://raw.githubusercontent.com/mit-satori/getting-started/master/lsf-templates/template-caffetest-singlenode.lsf
bsub &lt; template-caffetest-singlenode.lsf
bjobs
bjobs
bpeek
bpeek
bpeek
bjobs
</pre></div>
</div>
<p>The template-caffe-test-singlenode.lsf consist in the following LSF file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#BSUB -L /bin/bash</span>
<span class="c1">#BSUB -J &quot;caffe-test&quot;</span>
<span class="c1">#BSUB -o &quot;caffe-test_o.%J&quot;</span>
<span class="c1">#BSUB -e &quot;caffe-test_e.%J&quot;</span>
<span class="c1">#BSUB -n 4</span>
<span class="c1">#BSUB -R &quot;span[ptile=4]&quot;</span>
<span class="c1">#BSUB -gpu &quot;num=4&quot;</span>
<span class="c1">#BSUB -q &quot;normal&quot;</span>
<span class="c1">#BSUB -x</span>

<span class="nv">HOME2</span><span class="o">=</span>/nobackup/users/<span class="k">$(</span>whoami<span class="k">)</span>
<span class="nv">PYTHON_VIRTUAL_ENVIRONMENT</span><span class="o">=</span>wmlce-1.6.2
<span class="nv">CONDA_ROOT</span><span class="o">=</span><span class="nv">$HOME2</span>/anaconda3
<span class="nb">source</span> <span class="si">${</span><span class="nv">CONDA_ROOT</span><span class="si">}</span>/etc/profile.d/conda.sh
conda activate <span class="nv">$PYTHON_VIRTUAL_ENVIRONMENT</span>

caffe-test
</pre></div>
</div>
<p>You can try even your custom ML/DL code; in case you have missing
libraries don’t forget to install them with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda instal &lt;package name&gt;
pip install &lt;package name&gt;
</pre></div>
</div>
<p>If you don’t have any more errors you are ready to submit jobs on the
compute nodes :)</p>
<div class="section" id="controlling-wmlce-release-packages">
<h3>Controlling WMLCE release packages<a class="headerlink" href="#controlling-wmlce-release-packages" title="Permalink to this headline">¶</a></h3>
<p>The conda installer uses a set of rules to determine which packages to
install. Channel priorities and package versions are weighted heavily,
but the installer also considers factors such as the number of packages
that would need to be installed, whether any packages would need to be
upgraded or removed, and so on.</p>
<p>The conda installer will sometimes come up with a surprising
installation solution. It may prefer to install: Packages from Anaconda
channels over the WML CE channel in spite of channel priorities.
Packages from an older release of WML CE in spite of newer versions
being available. You can guide the conda installer to ensure that it
chooses the desired WML CE package using the strict channel priority
option and the powerai-release meta-package.</p>
<ol class="loweralpha simple">
<li>Strict channel priority</li>
</ol>
<p>The strict channel priority option forces the conda installer to give
additional weight to the priority of channels defined in the
configuration. It is useful in cases where the conda installer is
preferring packages from lower-priority channels. The simplest use is
just to add –strict-channel-priority to the install command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install --strict-channel-priority tensorflow
</pre></div>
</div>
<p>You can check the priority of the channels in the configuration by
running the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda config --show
...
channel_priority: flexible
channels:
  - https://public.dhe.ibm.com/ibmdl/export/pub/software/server/ibm-ai/conda/
  - defaults
...
</pre></div>
</div>
<p>You could permanently change the channel priority setting to strict:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda config --set channel_priority strict
</pre></div>
</div>
<ol class="loweralpha simple" start="2">
<li>WMLCE release meta-package</li>
</ol>
<p>The powerai-release meta-package can be used to specify the WML CE
release you want to install from. It is useful when the installer
prefers packages from an earlier release, or if you intentionally want
to install packages from an older release. Examples:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>my-wmlce-env<span class="o">)</span> $ conda install pytorch powerai-release<span class="o">=</span><span class="m">1</span>.6.2
<span class="o">(</span>my-wmlce-env<span class="o">)</span> $ conda install pytorch powerai-release<span class="o">=</span><span class="m">1</span>.6.1
</pre></div>
</div>
<p>The –strict-channel-priority option can be used with powerai-release for
greater control:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install --strict-channel-priority pytorch powerai-release<span class="o">=</span><span class="m">1</span>.6.2
</pre></div>
</div>
</div>
<div class="section" id="additional-conda-channels">
<h3>Additional conda channels<a class="headerlink" href="#additional-conda-channels" title="Permalink to this headline">¶</a></h3>
<p>The main WML CE conda channel is described above. That channel includes
the formal, supported WML CE releases.</p>
<p>Additional conda channels are available to complement the main channel.
Packages in these channels are not formally supported. Both of these
channels are optional. WML CE will install and run fine without either.
They can also be used independently of each other (Supplementary does
not need Early Access or vice versa). Use them if you want the packages
they provide and do not need formal support.</p>
</div>
</div>
<div class="section" id="the-wml-ce-supplementary-channel-is-available-at-https-anaconda-org-powerai">
<h2>The WML CE Supplementary channel is available at: <a class="reference external" href="https://anaconda.org/powerai/" target="_blank">https://anaconda.org/powerai/</a>.<a class="headerlink" href="#the-wml-ce-supplementary-channel-is-available-at-https-anaconda-org-powerai" title="Permalink to this headline">¶</a></h2>
<p>This channel includes packages that are not part of WML CE, but which
may be useful to WML CE users. The packages are built from recipes in
the WML CE GitHub repository: <a class="reference external" href="https://github.com/ibm/powerai" target="_blank">https://github.com/ibm/powerai</a>.</p>
<p>Problem reports and recipe contributions from the community are welcome.
More information about the Supplementary channel can be found in the
PowerAI Supplementary Channel README.</p>
</div>
<div class="section" id="the-wml-ce-early-access-channel-is-available-at-https-public-dhe-ibm-com-ibmdl-export-pub-software-server-ibm-ai-conda-early-access">
<h2>The WML CE Early Access channel is available at: <a class="reference external" href="https://public.dhe.ibm.com/ibmdl/export/pub/software/server/ibm-ai/conda-early-access/" target="_blank">https://public.dhe.ibm.com/ibmdl/export/pub/software/server/ibm-ai/conda-early-access/</a>.<a class="headerlink" href="#the-wml-ce-early-access-channel-is-available-at-https-public-dhe-ibm-com-ibmdl-export-pub-software-server-ibm-ai-conda-early-access" title="Permalink to this headline">¶</a></h2>
<p>This channel is updated occasionally with latest versions of various
packages included in WML CE. The purpose of the channel is to make new
versions of frameworks available in advance of formal WML CE releases.
Packages published in the Early Access channel may not exactly match a
later WML CE release. For example, package and prerequisite versions may
differ.</p>
<p>Packages in the Early Access channel might depend on packages in the
main channel, so both channels might be needed in the conda config.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">MIT Satori User Documentation</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">IBM Watson Machine Learning Community Edition (WMLCE)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#install-anaconda">[1] Install Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wmlce-setting-up-the-software-repository">[2] WMLCE: Setting up the software repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wmlce-creating-and-activate-conda-environments-recommended">[3] WMLCE: Creating and activate conda environments (recommended)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wmlce-installing-all-frameworks-at-the-same-time">[4] WMLCE: Installing all frameworks at the same time</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wmlce-testing-ml-dl-frameworks-pytorch-tensorflow-etc-installation">[5] WMLCE: Testing ML/DL frameworks (Pytorch, TensorFlow etc) installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-wml-ce-supplementary-channel-is-available-at-https-anaconda-org-powerai">The WML CE Supplementary channel is available at: https://anaconda.org/powerai/.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-wml-ce-early-access-channel-is-available-at-https-public-dhe-ibm-com-ibmdl-export-pub-software-server-ibm-ai-conda-early-access">The WML CE Early Access channel is available at: https://public.dhe.ibm.com/ibmdl/export/pub/software/server/ibm-ai/conda-early-access/.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="satori-distributed-deeplearning.html">Distributed Deep Learning</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Satori Quick Start Info</a></li>
      <li>Next: <a href="satori-distributed-deeplearning.html" title="next chapter">Distributed Deep Learning</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, MIT.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/satori-ai-frameworks.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>